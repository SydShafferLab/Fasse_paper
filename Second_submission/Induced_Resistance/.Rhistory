library(readr)
library(readxl)
library(dplyr)
library(ggplot2)
knitr::opts_knit$set(root.dir = '/Users/phoebewhite/Library/CloudStorage/GoogleDrive-phwhite@sas.upenn.edu/.shortcut-targets-by-id/12tKUWWdMW6Is2j_X0QWarfY8tIR_UEj9/White_Shared/cloud/experiment_ids/pw023')
colors <- c('500' = '#21618C',
'1000' = '#95A5A6',
'5000' = '#B03A2E')
colors_il6st <- c('Low' = '#55C0EE',
'High' = '#EF3E69')
#dir.create('cellarea_count')
load('cellarea_count/rdata/areas_exp.RData')
load('cellarea_count/rdata/areas_ctrl.RData')
load('cellarea_count/rdata/pvals.RData')
# Log2 FC w pval
pdf(file="cellarea_count/plots/log2_pval_norm_1000.pdf")
for(i in unique(area_df$seeding_num)) {
if(i == '1000'){
t <- filter_all(area_df, any_vars(.==i))
t$il6st <- factor(t$il6st, levels = c("Low", "High"))
p <- filter_all(pvals_df, any_vars(.==i))
print(ggplot(t) +
geom_violin(aes(x= il6st, y= log2(norm_area), fill = il6st)) +
geom_point(aes(x= il6st, y= log2(norm_area)), color = 'black') +
labs(x="il6st level", y="log2(cell area)", title="log2(norm cell area)", subtitle = paste('pvalue =', signif(p$pval, digits = 5))) +
scale_fill_manual(values = colors_il6st))
}
}
dev.off()
pdf(file="cellarea_count/plots/log2_norm.pdf")
area_df$il6st <- factor(area_df$il6st, levels = c("Low", "High"))
area_df$seeding_num <- factor(area_df$seeding_num, levels = c("500", "1000", "5000"))
ggplot(area_df) +
geom_violin(aes(x = interaction(il6st, seeding_num), y = log2(norm_area), fill = il6st)) +
geom_point(aes(x = interaction(il6st, seeding_num), y = log2(norm_area)), color = 'black') +
labs(x = "il6st level", y = "log2(norm cell area)", title = "log2(norm cell area)", subtitle = pvals_df) +
scale_fill_manual(values = colors_il6st)
dev.off()
