---
title: "2022_06_17_Find Induced Resistance"
output: html_notebook
---

#Set working directory to appropriate folder for inputs and outputs on Google Drive
```{r, setup, include=FALSE}
knitr::opts_knit$set(root.dir = '/Volumes/GoogleDrive/My Drive/Fasse_Shared/AJF_Drive_copy/Experiments/AJF009') # for aria's computer
#knitr::opts_knit$set(root.dir = '/Volumes/GoogleDrive/.shortcut-targets-by-id/1zSqx3IzXMwt6clUjwyqmlOf4G1K53lvy/Fasse_Shared/AJF_Drive_copy/Experiments/AJF009') # for dylan's computer

#2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/ is additional path for outputs

```

# Initialize
```{r include = FALSE}
rm(list = ls())
library(dplyr)
library(Seurat)
library(ggplot2)
library(RColorBrewer)
library(kit)
library(cowplot)
`%nin%` = Negate(`%in%`)

```

# Assign directory and load files
```{r include = FALSE}

load('2022_01_14_analysis_scripts/2022_05_27_analysis/Assign_dominant_barcodes/all_data_final_lineages.RData') #seurat object with final lineage assignments

load('2022_01_14_analysis_scripts/2022_05_27_analysis/Preprocess_gDNA/preprocessed_gDNA.RData') # need list of all gDNA reads per lineage

load('2022_01_14_analysis_scripts/2022_05_27_analysis/Filtering_cDNA/filtered_cDNA.RData') # need list of all lineages with cDNA representation
load('2022_01_14_analysis_scripts/2022_05_27_analysis/Filtering_cDNA/resistant_lineage_lists.RData') # list of lineages passing filtering

```


# Look at markers of induced resistant lineages (versus all? versus sensitive? difference is lineages that were resistant to both independently)
# expression of end resistant state markers in the induced resistant lineages
# do cells from these lineages cluster together?
# are cells from these lineages resistant to many or few conditions?
# how else do these lineages distinguish themselves?
# do we want to do a pathway analysis here?

# Build new object that defines induced resistance from gDNA_collapsed
# cross check against gDNA_cDNA_collapsed to look at things with cDNA representation
```{r}

nofilter_gDNA_lins <- list()
for (i in names(gDNA_collapsed)){
  if (i != 'FirstSample'){
  nofilter_gDNA_lins[[i]] <- gDNA_collapsed[[i]]$Lineage[gDNA_collapsed[[i]]$Reads > 1]
  }
}


dabtram_cocl2 <- list(dabtram = unique(c(nofilter_gDNA_lins$DabTram, nofilter_gDNA_lins$DabTramtoCis, nofilter_gDNA_lins$DabTramtoCoCl2, nofilter_gDNA_lins$DabTramtoDabTram)), 
                           cocl2 = unique(c(nofilter_gDNA_lins$CoCl2, nofilter_gDNA_lins$CoCl2toCis, nofilter_gDNA_lins$CoCl2toCoCl2, nofilter_gDNA_lins$CoCl2toDabTram)),
                           dabtramtococl2 = nofilter_gDNA_lins$DabTramtoCoCl2,
                           cocl2todabtram = nofilter_gDNA_lins$CoCl2toDabTram)

dabtram_cis <- list(dabtram = unique(c(nofilter_gDNA_lins$DabTram, nofilter_gDNA_lins$DabTramtoCis, nofilter_gDNA_lins$DabTramtoCoCl2, nofilter_gDNA_lins$DabTramtoDabTram)), 
                         cis = unique(c(nofilter_gDNA_lins$Cis, nofilter_gDNA_lins$CistoCis, nofilter_gDNA_lins$CistoCoCl2, nofilter_gDNA_lins$CistoDabTram)),
                         dabtramtocis = nofilter_gDNA_lins$DabTramtoCis,
                         cistodabtram = nofilter_gDNA_lins$CistoDabTram)

cocl2_cis <- list(cocl2 = unique(c(nofilter_gDNA_lins$CoCl2, nofilter_gDNA_lins$CoCl2toCis, nofilter_gDNA_lins$CoCl2toCoCl2, nofilter_gDNA_lins$CoCl2toDabTram)),
                       cis = (c(nofilter_gDNA_lins$Cis, nofilter_gDNA_lins$CistoCis, nofilter_gDNA_lins$CistoCoCl2, nofilter_gDNA_lins$CistoDabTram)),
                       cocl2tocis = nofilter_gDNA_lins$CoCl2toCis,
                       cistococl2 = nofilter_gDNA_lins$CistoCoCl2)

induced_resistant_lins <- list()

dabtram_cocl2_venn <- venn(dabtram_cocl2)
dabtram_cis_venn <- venn(dabtram_cis)
cocl2_cis_venn <- venn(cocl2_cis)

induced_resistant_lins[['DabTram_Inducedto_CoCl2']] = attr(dabtram_cocl2_venn, "intersections")$'dabtram:dabtramtococl2'
induced_resistant_lins[['CoCl2_Inducedto_DabTram']] = attr(dabtram_cocl2_venn, "intersections")$'cocl2:cocl2todabtram'

induced_resistant_lins[['DabTram_Inducedto_Cis']] = attr(dabtram_cis_venn, "intersections")$'dabtram:dabtramtocis'
induced_resistant_lins[['Cis_Inducedto_DabTram']] = attr(dabtram_cis_venn, "intersections")$'cis:cistodabtram'

induced_resistant_lins[['CoCl2_Inducedto_Cis']] = attr(cocl2_cis_venn, "intersections")$'cocl2:cocl2tocis'
induced_resistant_lins[['Cis_Inducedto_CoCl2']] = attr(cocl2_cis_venn, "intersections")$'cis:cistococl2'

```
#How many reads for each of these lineages? How many cells? Plot distribution of lineage size (cells? reads? which time?), correlation between time 1 and 2
```{r}
induced_resistant_df <- list()

for (i in names(induced_resistant_lins)){
  split <- strsplit(i, '_')
  time1 <- split[[1]][1]
  time2 <- paste0(split[[1]][1], 'to', split[[1]][3])
  
  test <- filter(gDNA_collapsed[[time1]], gDNA_collapsed[[time1]]$Lineage %in% induced_resistant_lins[[i]])
  colnames(test)[colnames(test) == "Reads"] <- "Reads_time1"
  colnames(test)[colnames(test) == "RPM"] <- "RPM_time1"

  test$Num_Cells_time1 <- rep(0, length(test$Lineage))
  test$Num_Cells_time2 <- rep(0, length(test$Lineage))
  test$Reads_time2 <- rep(0, length(test$Lineage))
  
  for (k in 1:length(test$Lineage)){
    lin <- test$Lineage[[k]]
  
    if (is.element(lin, gDNA_cDNA_collapsed[[time1]]$Lineage)){
      test$Num_Cells_time1[[k]] <- gDNA_cDNA_collapsed[[time1]]$Num_Cells[gDNA_cDNA_collapsed[[time1]]$Lineage == lin]
    }
    if (is.element(lin, gDNA_cDNA_collapsed[[time2]]$Lineage)){
      test$Num_Cells_time2[[k]] <- gDNA_cDNA_collapsed[[time2]]$Num_Cells[gDNA_cDNA_collapsed[[time2]]$Lineage == lin]
    }
    test$Reads_time2[[k]] <- gDNA_collapsed[[time2]]$Reads[gDNA_collapsed[[time2]]$Lineage == lin]
    
    test$Num_Cells_time1_norm[[k]] <- test$Num_Cells_time1[[k]] / length(all_data$OG_condition == time1)
    
  }
  induced_resistant_df[[i]] <- test  
}
```

#plotting cell # correlation between time 1 and 2
```{r}
for (i in names(induced_resistant_df)){
  print(ggplot(induced_resistant_df[[i]], aes(x = Num_Cells_time2, y = Num_Cells_time1)) + geom_point() + ggtitle(paste("per lineage # cells at time 1 vs time 2 in", i)))
}

# for (i in names(cDNA_excluded)){
#   print(ggplot(data = cDNA_excluded[[i]], aes(x = Num_Cells)) + geom_bar() + labs(x = 'Number of Cells per lineage', title = paste(i, "cDNA lineages lost in filtering")))
#   print(ggplot(data = gDNA_cDNA_collapsed[[i]], aes(x = Num_Cells)) + geom_bar() + labs(x = 'Number of Cells per lineage ', title = paste(i, "cDNA lineages prior to filtering")))      
# }
# dev.off()

```
<!-- ``` -->

<!-- # Dab induced to CoCl2 -->
<!-- ```{r include = FALSE} -->
<!-- #finding the lineages that end up induced resistant to cocl2, in the dabtram object -->
<!-- Dabtram_inducedto_CoCl2 <- names(all_data$Lineage[all_data$OG_condition == 'dabtram' & all_data$Lineage %in% induced_resistant_lins$Dabtram_Inducedto_CoCl2]) -->
<!-- Dabtram_not_inducedto_CoCl2 <- names(all_data$Lineage[all_data$OG_condition == 'dabtram' & all_data$Lineage %nin% induced_resistant_lins$Dabtram_Inducedto_CoCl2]) -->

<!-- # Get markers of dabrafenib induced to cocl2 resistance -->
<!-- Dabtram_inducedto_CoCl2_markers <- FindMarkers(all_data, ident.1 = Dabtram_inducedto_CoCl2, ident.2 = Dabtram_not_inducedto_CoCl2, logfc.threshold = 0.25) -->


<!-- #actually do need this for ridge plot-- also need separate dabtram object? -->
<!-- # # make metadata object for dabrafenib induced to cocl2 resistance -->
<!-- # dabtram_inducedto_cocl2_forvln <- rep(0, length(names(dabtram$Lineage))) -->
<!-- # dabtram_inducedto_cocl2_forvln[which(dabtram$Lineage %nin% c(final_induced_resistant_lins$Dabtram_Inducedto_CoCl2,"No Barcode","Still multiple"))] <- 'Sensitive' -->
<!-- # dabtram_inducedto_cocl2_forvln[which(dabtram$Lineage %in% c(final_induced_resistant_lins$Dabtram_Inducedto_CoCl2))] <- 'Induced Resistant' -->
<!-- # dabtram_inducedto_cocl2_forvln[which(dabtram$Lineage %in% c("No Barcode","Still multiple"))] <- 'No Barcode' -->
<!-- # dabtram$Dabtram_inducedto_CoCl2 <- dabtram_inducedto_cocl2_forvln -->
<!-- # Idents(dabtram) <- dabtram$Dabtram_inducedto_CoCl2 -->

<!-- ``` -->

<!-- # Plot the Dab resistant cells on naive umap -->
<!-- ```{r include = FALSE} -->
<!-- pdf('2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/dabtram_inducedto_cocl2_Markers.pdf') -->
<!-- DimPlot(all_data, reduction = "umap", dims = c(1,2), -->
<!--         group.by = 'Lineage', pt.size = .1, cells.highlight = list(Dabtram_inducedto_CoCl2), -->
<!--         cols.highlight = 'cyan') + ggtitle(paste('Dabrafenib induced resistance to CoCl2 - # cells:', length(Dabtram_inducedto_CoCl2))) -->

<!-- DimPlot(all_data, reduction = 'umap', dims = c(1,2), group.by = 'Lineage') + ggtitle('Ground Truths') -->

<!-- Dabtram_inducedto_CoCl2_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Dabtram_inducedto_CoCl2_markers$diffexpressed[Dabtram_inducedto_CoCl2_markers$avg_log2FC > 1 & Dabtram_inducedto_CoCl2_markers$p_val < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Dabtram_inducedto_CoCl2_markers$diffexpressed[Dabtram_inducedto_CoCl2_markers$avg_log2FC < -1 & Dabtram_inducedto_CoCl2_markers$p_val < 0.05] <- "DOWN" -->

<!-- Dabtram_inducedto_CoCl2_markers$delabel <- NA -->
<!-- Dabtram_inducedto_CoCl2_markers$delabel[Dabtram_inducedto_CoCl2_markers$diffexpressed != "NO"] <- rownames(Dabtram_inducedto_CoCl2_markers)[Dabtram_inducedto_CoCl2_markers$diffexpressed != "NO"] -->

<!-- ggplot(data=Dabtram_inducedto_CoCl2_markers, aes(x=avg_log2FC, y=-log10(p_val), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") + -->
<!--   ggtitle('p_val') -->

<!-- Dabtram_inducedto_CoCl2_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Dabtram_inducedto_CoCl2_markers$diffexpressed[Dabtram_inducedto_CoCl2_markers$avg_log2FC > 1 & Dabtram_inducedto_CoCl2_markers$p_val_adj < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Dabtram_inducedto_CoCl2_markers$diffexpressed[Dabtram_inducedto_CoCl2_markers$avg_log2FC < -1 & Dabtram_inducedto_CoCl2_markers$p_val_adj < 0.05] <- "DOWN" -->

<!-- Dabtram_inducedto_CoCl2_markers$delabel <- NA -->
<!-- Dabtram_inducedto_CoCl2_markers$delabel[Dabtram_inducedto_CoCl2_markers$diffexpressed != "NO"] <- rownames(Dabtram_inducedto_CoCl2_markers)[Dabtram_inducedto_CoCl2_markers$diffexpressed != "NO"] -->


<!-- ggplot(data=Dabtram_inducedto_CoCl2_markers, aes(x=avg_log2FC, y=-log10(p_val_adj), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") +  -->
<!--   ggtitle('p_val_adj') -->


<!-- for (i in rownames(Dabtram_inducedto_CoCl2_markers)[order(Dabtram_inducedto_CoCl2_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   p1 <- FeaturePlot(all_data, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   print(p1) -->
<!-- } -->

<!-- for (i in rownames(Dabtram_inducedto_CoCl2_markers)[order(Dabtram_inducedto_CoCl2_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   print(RidgePlot(all_data, features = i, idents = c('Induced Resistant','Sensitive'), cols = c('grey', 'cyan'))) -->
<!-- } -->
<!-- dev.off() -->
<!-- ``` -->


<!-- # Dab induced to Cis -->
<!-- ```{r} -->
<!-- Dabtram_not_inducedto_Cis <- names(dabtram$orig.ident[dabtram$Lineage %nin% c(final_induced_resistant_lins$Dabtram_Inducedto_Cis,"No Barcode","Still multiple") ])  -->
<!-- Dabtram_inducedto_Cis <- names(dabtram$orig.ident[dabtram$Lineage %in% final_induced_resistant_lins$Dabtram_Inducedto_Cis]) -->

<!-- # Get markers of dabrafenib induced to cocl2 resistance -->
<!-- Dabtram_inducedto_Cis_markers <- FindMarkers(dabtram, ident.1 = Dabtram_inducedto_Cis, ident.2 = Dabtram_not_inducedto_Cis, logfc.threshold = 0.25) -->

<!-- # make metadata object for dabrafenib induced to cocl2 resistance -->
<!-- dabtram_inducedto_cis_forvln <- rep(0, length(names(dabtram$Lineage))) -->
<!-- dabtram_inducedto_cis_forvln[which(dabtram$Lineage %nin% c(final_induced_resistant_lins$Dabtram_Inducedto_Cis,"No Barcode","Still multiple"))] <- 'Sensitive' -->
<!-- dabtram_inducedto_cis_forvln[which(dabtram$Lineage %in% c(final_induced_resistant_lins$Dabtram_Inducedto_Cis))] <- 'Induced Resistant' -->
<!-- dabtram_inducedto_cis_forvln[which(dabtram$Lineage %in% c("No Barcode","Still multiple"))] <- 'No Barcode' -->
<!-- dabtram$Dabtram_inducedto_Cis <- dabtram_inducedto_cis_forvln -->
<!-- Idents(dabtram) <- dabtram$Dabtram_inducedto_Cis -->

<!-- ``` -->

<!-- # Plot the Dab resistant cells on naive umap -->
<!-- ```{r include = FALSE} -->
<!-- pdf('2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/dabtram_inducedto_cis_Markers.pdf') -->
<!-- DimPlot(dabtram, reduction = "umap", dims = c(1,2), -->
<!--         group.by = 'Lineage', pt.size = .1, cells.highlight = list(Dabtram_inducedto_Cis), -->
<!--         cols.highlight = 'cyan') + ggtitle(paste('Dabrafenib induced resistance to Cis - # cells:', length(Dabtram_inducedto_Cis))) -->

<!-- DimPlot(dabtram, reduction = 'umap', dims = c(1,2)) + ggtitle('Ground Truths') -->

<!-- Dabtram_inducedto_Cis_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Dabtram_inducedto_Cis_markers$diffexpressed[Dabtram_inducedto_Cis_markers$avg_log2FC > 1 & Dabtram_inducedto_Cis_markers$p_val < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Dabtram_inducedto_Cis_markers$diffexpressed[Dabtram_inducedto_Cis_markers$avg_log2FC < -1 & Dabtram_inducedto_Cis_markers$p_val < 0.05] <- "DOWN" -->

<!-- Dabtram_inducedto_Cis_markers$delabel <- NA -->
<!-- Dabtram_inducedto_Cis_markers$delabel[Dabtram_inducedto_Cis_markers$diffexpressed != "NO"] <- rownames(Dabtram_inducedto_Cis_markers)[Dabtram_inducedto_Cis_markers$diffexpressed != "NO"] -->

<!-- ggplot(data=Dabtram_inducedto_Cis_markers, aes(x=avg_log2FC, y=-log10(p_val), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") + -->
<!--   ggtitle('p_val') -->

<!-- Dabtram_inducedto_Cis_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Dabtram_inducedto_Cis_markers$diffexpressed[Dabtram_inducedto_Cis_markers$avg_log2FC > 1 & Dabtram_inducedto_Cis_markers$p_val_adj < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Dabtram_inducedto_Cis_markers$diffexpressed[Dabtram_inducedto_Cis_markers$avg_log2FC < -1 & Dabtram_inducedto_Cis_markers$p_val_adj < 0.05] <- "DOWN" -->

<!-- Dabtram_inducedto_Cis_markers$delabel <- NA -->
<!-- Dabtram_inducedto_Cis_markers$delabel[Dabtram_inducedto_Cis_markers$diffexpressed != "NO"] <- rownames(Dabtram_inducedto_Cis_markers)[Dabtram_inducedto_Cis_markers$diffexpressed != "NO"] -->


<!-- ggplot(data=Dabtram_inducedto_Cis_markers, aes(x=avg_log2FC, y=-log10(p_val_adj), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") +  -->
<!--   ggtitle('p_val_adj') -->


<!-- for (i in rownames(Dabtram_inducedto_Cis_markers)[order(Dabtram_inducedto_Cis_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   p1 <- FeaturePlot(dabtram, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   p2 <- FeaturePlot(dabtram_first, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   print(plot_grid(p1,p2)) -->
<!-- } -->

<!-- for (i in rownames(Dabtram_inducedto_Cis_markers)[order(Dabtram_inducedto_Cis_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   print(RidgePlot(dabtram, features = i, idents = c('Induced Resistant','Sensitive'), cols = c('grey', 'cyan'))) -->
<!-- } -->
<!-- dev.off() -->

<!-- ``` -->

<!-- # CoCl2 induced to Dabtram -->
<!-- ```{r} -->
<!-- CoCl2_not_inducedto_Dabtram <- names(cocl2$orig.ident[cocl2$Lineage %nin% c(final_induced_resistant_lins$CoCl2_Inducedto_DabTram,"No Barcode","Still multiple") ])  -->
<!-- CoCl2_inducedto_Dabtram <- names(cocl2$orig.ident[cocl2$Lineage %in% final_induced_resistant_lins$CoCl2_Inducedto_DabTram]) -->

<!-- # Get markers of dabrafenib induced to cocl2 resistance -->
<!-- CoCl2_inducedto_Dabtram_markers <- FindMarkers(cocl2, ident.1 = CoCl2_not_inducedto_Dabtram, ident.2 = CoCl2_inducedto_Dabtram, logfc.threshold = 0.25) -->

<!-- # make metadata object for dabrafenib induced to cocl2 resistance -->
<!-- cocl2_inducedto_dabtram_forvln <- rep(0, length(names(cocl2$Lineage))) -->
<!-- cocl2_inducedto_dabtram_forvln[which(cocl2$Lineage %nin% c(final_induced_resistant_lins$CoCl2_Inducedto_DabTram,"No Barcode","Still multiple"))] <- 'Sensitive' -->
<!-- cocl2_inducedto_dabtram_forvln[which(cocl2$Lineage %in% c(final_induced_resistant_lins$CoCl2_Inducedto_DabTram))] <- 'Induced Resistant' -->
<!-- cocl2_inducedto_dabtram_forvln[which(cocl2$Lineage %in% c("No Barcode","Still multiple"))] <- 'No Barcode' -->
<!-- cocl2$CoCl2_inducedto_Dabtram <- cocl2_inducedto_dabtram_forvln -->
<!-- Idents(cocl2) <- cocl2$CoCl2_inducedto_Dabtram -->

<!-- ``` -->

<!-- # Plot the Dab resistant cells on naive umap -->
<!-- ```{r include = FALSE} -->
<!-- pdf('2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/cocl2_inducedto_dabtram_Markers.pdf') -->
<!-- DimPlot(cocl2, reduction = "umap", dims = c(1,2), -->
<!--         group.by = 'Lineage', pt.size = .1, cells.highlight = list(CoCl2_inducedto_Dabtram), -->
<!--         cols.highlight = 'cyan') + ggtitle(paste('CoCl2 induced resistance to dabtram - # cells:', length(CoCl2_inducedto_Dabtram))) -->

<!-- DimPlot(cocl2, reduction = 'umap', dims = c(1,2)) + ggtitle('Ground Truths') -->

<!-- CoCl2_inducedto_Dabtram_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- CoCl2_inducedto_Dabtram_markers$diffexpressed[CoCl2_inducedto_Dabtram_markers$avg_log2FC > 1 & CoCl2_inducedto_Dabtram_markers$p_val < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- CoCl2_inducedto_Dabtram_markers$diffexpressed[CoCl2_inducedto_Dabtram_markers$avg_log2FC < -1 & CoCl2_inducedto_Dabtram_markers$p_val < 0.05] <- "DOWN" -->

<!-- CoCl2_inducedto_Dabtram_markers$delabel <- NA -->
<!-- CoCl2_inducedto_Dabtram_markers$delabel[CoCl2_inducedto_Dabtram_markers$diffexpressed != "NO"] <- rownames(CoCl2_inducedto_Dabtram_markers)[CoCl2_inducedto_Dabtram_markers$diffexpressed != "NO"] -->

<!-- ggplot(data=CoCl2_inducedto_Dabtram_markers, aes(x=avg_log2FC, y=-log10(p_val), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") + -->
<!--   ggtitle('p_val') -->

<!-- CoCl2_inducedto_Dabtram_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- CoCl2_inducedto_Dabtram_markers$diffexpressed[CoCl2_inducedto_Dabtram_markers$avg_log2FC > 1 & CoCl2_inducedto_Dabtram_markers$p_val_adj < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- CoCl2_inducedto_Dabtram_markers$diffexpressed[CoCl2_inducedto_Dabtram_markers$avg_log2FC < -1 & CoCl2_inducedto_Dabtram_markers$p_val_adj < 0.05] <- "DOWN" -->

<!-- CoCl2_inducedto_Dabtram_markers$delabel <- NA -->
<!-- CoCl2_inducedto_Dabtram_markers$delabel[CoCl2_inducedto_Dabtram_markers$diffexpressed != "NO"] <- rownames(CoCl2_inducedto_Dabtram_markers)[CoCl2_inducedto_Dabtram_markers$diffexpressed != "NO"] -->


<!-- ggplot(data=CoCl2_inducedto_Dabtram_markers, aes(x=avg_log2FC, y=-log10(p_val_adj), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") +  -->
<!--   ggtitle('p_val_adj') -->


<!-- for (i in rownames(CoCl2_inducedto_Dabtram_markers)[order(CoCl2_inducedto_Dabtram_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   p1 <- FeaturePlot(cocl2, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   p2 <- FeaturePlot(cocl2_first, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   print(plot_grid(p1,p2)) -->
<!-- } -->

<!-- for (i in rownames(CoCl2_inducedto_Dabtram_markers)[order(CoCl2_inducedto_Dabtram_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   print(RidgePlot(cocl2, features = i, idents = c('Induced Resistant','Sensitive'), cols = c('grey', 'cyan'))) -->
<!-- } -->
<!-- dev.off() -->
<!-- ``` -->


<!-- # CoCl2 induced to cis -->
<!-- ```{r} -->
<!-- CoCl2_not_inducedto_Cis <- names(cocl2$orig.ident[cocl2$Lineage %nin% c(final_induced_resistant_lins$CoCl2_Inducedto_Cis,"No Barcode","Still multiple") ])  -->
<!-- CoCl2_inducedto_Cis <- names(cocl2$orig.ident[cocl2$Lineage %in% final_induced_resistant_lins$CoCl2_Inducedto_Cis]) -->

<!-- # Get markers of dabrafenib induced to cocl2 resistance -->
<!-- CoCl2_inducedto_Cis_markers <- FindMarkers(cocl2, ident.1 = CoCl2_not_inducedto_Cis, ident.2 = CoCl2_inducedto_Cis, logfc.threshold = 0.25) -->

<!-- # make metadata object for dabrafenib induced to cocl2 resistance -->
<!-- cocl2_inducedto_cis_forvln <- rep(0, length(names(cocl2$Lineage))) -->
<!-- cocl2_inducedto_cis_forvln[which(cocl2$Lineage %nin% c(final_induced_resistant_lins$CoCl2_Inducedto_Cis,"No Barcode","Still multiple"))] <- 'Sensitive' -->
<!-- cocl2_inducedto_cis_forvln[which(cocl2$Lineage %in% c(final_induced_resistant_lins$CoCl2_Inducedto_Cis))] <- 'Induced Resistant' -->
<!-- cocl2_inducedto_cis_forvln[which(cocl2$Lineage %in% c("No Barcode","Still multiple"))] <- 'No Barcode' -->
<!-- cocl2$CoCl2_inducedto_cis <- cocl2_inducedto_cis_forvln -->
<!-- Idents(cocl2) <- cocl2$CoCl2_inducedto_cis -->

<!-- ``` -->

<!-- # Plot the Dab resistant cells on naive umap -->
<!-- ```{r include = FALSE} -->
<!-- pdf('2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/cocl2_inducedto_cis_Markers.pdf') -->
<!-- DimPlot(cocl2, reduction = "umap", dims = c(1,2), -->
<!--         group.by = 'Lineage', pt.size = .1, cells.highlight = list(CoCl2_inducedto_Cis), -->
<!--         cols.highlight = 'cyan') + ggtitle(paste('CoCl2 induced resistance to cis - # cells:', length(CoCl2_inducedto_Cis))) -->

<!-- DimPlot(cocl2, reduction = 'umap', dims = c(1,2)) + ggtitle('Ground Truths') -->

<!-- CoCl2_inducedto_Cis_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- CoCl2_inducedto_Cis_markers$diffexpressed[CoCl2_inducedto_Cis_markers$avg_log2FC > 1 & CoCl2_inducedto_Cis_markers$p_val < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- CoCl2_inducedto_Cis_markers$diffexpressed[CoCl2_inducedto_Cis_markers$avg_log2FC < -1 & CoCl2_inducedto_Cis_markers$p_val < 0.05] <- "DOWN" -->

<!-- CoCl2_inducedto_Cis_markers$delabel <- NA -->
<!-- CoCl2_inducedto_Cis_markers$delabel[CoCl2_inducedto_Cis_markers$diffexpressed != "NO"] <- rownames(CoCl2_inducedto_Cis_markers)[CoCl2_inducedto_Cis_markers$diffexpressed != "NO"] -->

<!-- ggplot(data=CoCl2_inducedto_Cis_markers, aes(x=avg_log2FC, y=-log10(p_val), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") + -->
<!--   ggtitle('p_val') -->

<!-- CoCl2_inducedto_Cis_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- CoCl2_inducedto_Cis_markers$diffexpressed[CoCl2_inducedto_Cis_markers$avg_log2FC > 1 & CoCl2_inducedto_Cis_markers$p_val_adj < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- CoCl2_inducedto_Cis_markers$diffexpressed[CoCl2_inducedto_Cis_markers$avg_log2FC < -1 & CoCl2_inducedto_Cis_markers$p_val_adj < 0.05] <- "DOWN" -->

<!-- CoCl2_inducedto_Cis_markers$delabel <- NA -->
<!-- CoCl2_inducedto_Cis_markers$delabel[CoCl2_inducedto_Cis_markers$diffexpressed != "NO"] <- rownames(CoCl2_inducedto_Cis_markers)[CoCl2_inducedto_Cis_markers$diffexpressed != "NO"] -->


<!-- ggplot(data=CoCl2_inducedto_Cis_markers, aes(x=avg_log2FC, y=-log10(p_val_adj), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") +  -->
<!--   ggtitle('p_val_adj') -->


<!-- for (i in rownames(CoCl2_inducedto_Cis_markers)[order(CoCl2_inducedto_Cis_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   p1 <- FeaturePlot(cocl2, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   p2 <- FeaturePlot(cocl2_first, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   print(plot_grid(p1,p2)) -->
<!-- } -->

<!-- for (i in rownames(CoCl2_inducedto_Cis_markers)[order(CoCl2_inducedto_Cis_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   print(RidgePlot(cocl2, features = i, idents = c('Induced Resistant','Sensitive'), cols = c('grey', 'cyan'))) -->
<!-- } -->
<!-- dev.off() -->
<!-- ``` -->

<!-- # Cis induced to dabtram -->
<!-- ```{r} -->
<!-- Cis_not_inducedto_Dabtram <- names(cis$orig.ident[cis$Lineage %nin% c(final_induced_resistant_lins$Cis_Inducedto_DabTram,"No Barcode","Still multiple") ])  -->
<!-- Cis_inducedto_Dabtram <- names(cis$orig.ident[cis$Lineage %in% final_induced_resistant_lins$Cis_Inducedto_DabTram]) -->

<!-- # Get markers of dabrafenib induced to cocl2 resistance -->
<!-- Cis_inducedto_Dabtram_markers <- FindMarkers(cis, ident.1 = Cis_not_inducedto_Dabtram, ident.2 = Cis_inducedto_Dabtram, logfc.threshold = 0.25) -->

<!-- # make metadata object for dabrafenib induced to cocl2 resistance -->
<!-- cis_inducedto_dabtram_forvln <- rep(0, length(names(cis$Lineage))) -->
<!-- cis_inducedto_dabtram_forvln[which(cis$Lineage %nin% c(final_induced_resistant_lins$Cis_Inducedto_DabTram,"No Barcode","Still multiple"))] <- 'Sensitive' -->
<!-- cis_inducedto_dabtram_forvln[which(cis$Lineage %in% c(final_induced_resistant_lins$Cis_Inducedto_DabTram))] <- 'Induced Resistant' -->
<!-- cis_inducedto_dabtram_forvln[which(cis$Lineage %in% c("No Barcode","Still multiple"))] <- 'No Barcode' -->
<!-- cis$Cis_inducedto_Dabtram <- cis_inducedto_dabtram_forvln -->
<!-- Idents(cis) <- cis$Cis_inducedto_Dabtram -->

<!-- ``` -->

<!-- # Plot the Dab resistant cells on naive umap -->
<!-- ```{r include = FALSE} -->
<!-- pdf('2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/cis_inducedto_dabtram_Markers.pdf') -->
<!-- DimPlot(cis, reduction = "umap", dims = c(1,2), -->
<!--         group.by = 'Lineage', pt.size = .1, cells.highlight = list(Cis_inducedto_Dabtram), -->
<!--         cols.highlight = 'cyan') + ggtitle(paste('Cis induced to dabtram - # cells:', length(Cis_inducedto_Dabtram))) -->

<!-- DimPlot(cis, reduction = 'umap', dims = c(1,2)) + ggtitle('Ground Truths') -->

<!-- Cis_inducedto_Dabtram_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Cis_inducedto_Dabtram_markers$diffexpressed[Cis_inducedto_Dabtram_markers$avg_log2FC > 1 & Cis_inducedto_Dabtram_markers$p_val < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Cis_inducedto_Dabtram_markers$diffexpressed[Cis_inducedto_Dabtram_markers$avg_log2FC < -1 & Cis_inducedto_Dabtram_markers$p_val < 0.05] <- "DOWN" -->

<!-- Cis_inducedto_Dabtram_markers$delabel <- NA -->
<!-- Cis_inducedto_Dabtram_markers$delabel[Cis_inducedto_Dabtram_markers$diffexpressed != "NO"] <- rownames(Cis_inducedto_Dabtram_markers)[Cis_inducedto_Dabtram_markers$diffexpressed != "NO"] -->

<!-- ggplot(data=Cis_inducedto_Dabtram_markers, aes(x=avg_log2FC, y=-log10(p_val), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") + -->
<!--   ggtitle('p_val') -->

<!-- Cis_inducedto_Dabtram_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Cis_inducedto_Dabtram_markers$diffexpressed[Cis_inducedto_Dabtram_markers$avg_log2FC > 1 & Cis_inducedto_Dabtram_markers$p_val_adj < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Cis_inducedto_Dabtram_markers$diffexpressed[Cis_inducedto_Dabtram_markers$avg_log2FC < -1 & Cis_inducedto_Dabtram_markers$p_val_adj < 0.05] <- "DOWN" -->

<!-- Cis_inducedto_Dabtram_markers$delabel <- NA -->
<!-- Cis_inducedto_Dabtram_markers$delabel[Cis_inducedto_Dabtram_markers$diffexpressed != "NO"] <- rownames(Cis_inducedto_Dabtram_markers)[Cis_inducedto_Dabtram_markers$diffexpressed != "NO"] -->


<!-- ggplot(data=Cis_inducedto_Dabtram_markers, aes(x=avg_log2FC, y=-log10(p_val_adj), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") +  -->
<!--   ggtitle('p_val_adj') -->


<!-- for (i in rownames(Cis_inducedto_Dabtram_markers)[order(Cis_inducedto_Dabtram_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   p1 <- FeaturePlot(cis, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   p2 <- FeaturePlot(cis_first, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   print(plot_grid(p1,p2)) -->
<!-- } -->

<!-- for (i in rownames(Cis_inducedto_Dabtram_markers)[order(Cis_inducedto_Dabtram_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   print(RidgePlot(cis, features = i, idents = c('Induced Resistant','Sensitive'), cols = c('grey', 'cyan'))) -->
<!-- } -->
<!-- dev.off() -->
<!-- ``` -->

<!-- # Cis induced to cocl2 -->
<!-- ```{r} -->
<!-- Cis_not_inducedto_CoCl2 <- names(cis$orig.ident[cis$Lineage %nin% c(final_induced_resistant_lins$Cis_Inducedto_CoCl2,"No Barcode","Still multiple") ])  -->
<!-- Cis_inducedto_CoCl2 <- names(cis$orig.ident[cis$Lineage %in% final_induced_resistant_lins$Cis_Inducedto_CoCl2]) -->

<!-- # Get markers of dabrafenib induced to cocl2 resistance -->
<!-- Cis_inducedto_CoCl2_markers <- FindMarkers(cis, ident.1 = Cis_not_inducedto_CoCl2, ident.2 = Cis_inducedto_CoCl2, logfc.threshold = 0.25) -->

<!-- # make metadata object for dabrafenib induced to cocl2 resistance -->
<!-- cis_inducedto_cocl2_forvln <- rep(0, length(names(cis$Lineage))) -->
<!-- cis_inducedto_cocl2_forvln[which(cis$Lineage %nin% c(final_induced_resistant_lins$Cis_Inducedto_CoCl2,"No Barcode","Still multiple"))] <- 'Sensitive' -->
<!-- cis_inducedto_cocl2_forvln[which(cis$Lineage %in% c(final_induced_resistant_lins$Cis_Inducedto_CoCl2))] <- 'Induced Resistant' -->
<!-- cis_inducedto_cocl2_forvln[which(cis$Lineage %in% c("No Barcode","Still multiple"))] <- 'No Barcode' -->
<!-- cis$Cis_inducedto_CoCl2 <- cis_inducedto_cocl2_forvln -->
<!-- Idents(cis) <- cis$Cis_inducedto_CoCl2 -->

<!-- ``` -->

<!-- # Plot the Dab resistant cells on naive umap -->
<!-- ```{r include = FALSE} -->
<!-- pdf('2022_01_14_analysis_scripts/2022_05_27_analysis/Induced_Resistance/cis_inducedto_cocl2_Markers.pdf') -->
<!-- DimPlot(cis, reduction = "umap", dims = c(1,2), -->
<!--         group.by = 'Lineage', pt.size = .1, cells.highlight = list(Cis_inducedto_CoCl2), -->
<!--         cols.highlight = 'cyan') + ggtitle(paste('Cis induced to cocl2 - # cells:', length(Cis_inducedto_CoCl2))) -->

<!-- DimPlot(cis, reduction = 'umap', dims = c(1,2)) + ggtitle('Ground Truths') -->

<!-- Cis_inducedto_CoCl2_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Cis_inducedto_CoCl2_markers$diffexpressed[Cis_inducedto_CoCl2_markers$avg_log2FC > 1 & Cis_inducedto_CoCl2_markers$p_val < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Cis_inducedto_CoCl2_markers$diffexpressed[Cis_inducedto_CoCl2_markers$avg_log2FC < -1 & Cis_inducedto_CoCl2_markers$p_val < 0.05] <- "DOWN" -->

<!-- Cis_inducedto_CoCl2_markers$delabel <- NA -->
<!-- Cis_inducedto_CoCl2_markers$delabel[Cis_inducedto_CoCl2_markers$diffexpressed != "NO"] <- rownames(Cis_inducedto_CoCl2_markers)[Cis_inducedto_CoCl2_markers$diffexpressed != "NO"] -->

<!-- ggplot(data=Cis_inducedto_CoCl2_markers, aes(x=avg_log2FC, y=-log10(p_val), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") + -->
<!--   ggtitle('p_val') -->

<!-- Cis_inducedto_CoCl2_markers$diffexpressed <- "NO" -->
<!-- # if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"  -->
<!-- Cis_inducedto_CoCl2_markers$diffexpressed[Cis_inducedto_CoCl2_markers$avg_log2FC > 1 & Cis_inducedto_CoCl2_markers$p_val_adj < 0.05] <- "UP" -->
<!-- # if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN" -->
<!-- Cis_inducedto_CoCl2_markers$diffexpressed[Cis_inducedto_CoCl2_markers$avg_log2FC < -1 & Cis_inducedto_CoCl2_markers$p_val_adj < 0.05] <- "DOWN" -->

<!-- Cis_inducedto_CoCl2_markers$delabel <- NA -->
<!-- Cis_inducedto_CoCl2_markers$delabel[Cis_inducedto_CoCl2_markers$diffexpressed != "NO"] <- rownames(Cis_inducedto_CoCl2_markers)[Cis_inducedto_CoCl2_markers$diffexpressed != "NO"] -->


<!-- ggplot(data=Cis_inducedto_CoCl2_markers, aes(x=avg_log2FC, y=-log10(p_val_adj), col=diffexpressed, label=delabel)) + -->
<!--   geom_point() +  -->
<!--   theme_minimal() + -->
<!--   geom_text() + -->
<!--   scale_color_manual(values=c("blue", "black", "red")) + -->
<!--   geom_vline(xintercept=c(-1, 1), col="red") + -->
<!--   geom_hline(yintercept=-log10(0.05), col="red") +  -->
<!--   ggtitle('p_val_adj') -->


<!-- for (i in rownames(Cis_inducedto_CoCl2_markers)[order(Cis_inducedto_CoCl2_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   p1 <- FeaturePlot(cis, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   p2 <- FeaturePlot(cis_first, features = i) & scale_colour_gradientn(colors = rev(brewer.pal(n = 11, name = 'RdBu'))) -->
<!--   print(plot_grid(p1,p2)) -->
<!-- } -->

<!-- for (i in rownames(Cis_inducedto_CoCl2_markers)[order(Cis_inducedto_CoCl2_markers$avg_log2FC, decreasing = T)][1:20]){ -->
<!--   print(RidgePlot(cis, features = i, idents = c('Induced Resistant','Sensitive'), cols = c('grey', 'cyan'))) -->
<!-- } -->
<!-- dev.off() -->
<!-- ``` -->

